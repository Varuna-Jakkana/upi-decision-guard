{% extends "base.html" %}
{% block content %}
<style>
  /* Theme-aware label colors */
  [data-theme="light"] .setup-label {
    color: #1f2937;
  }

  [data-theme="dark"] .setup-label {
    color: #e5e7eb;
  }

  [data-theme="light"] .setup-heading {
    color: #111827;
  }

  [data-theme="dark"] .setup-heading {
    color: #f3f4f6;
  }
</style>

<div class="glass-card fade-in-up" style="max-width: 500px; margin: 0 auto;">
  <h2 class="setup-heading">ğŸ¦ Setup Your Monthly Budget</h2>
  {% if error %}
  <div
    style="background: #fee2e2; color: #dc2626; padding: 15px; border-radius: 8px; margin: 10px 0; border: 2px solid #ef4444;">
    <strong>ğŸš« {{ error }}</strong>
  </div>
  {% endif %}
  <form method="POST" onsubmit="return checkBudget();">
    <label class="setup-label" style="display: block; margin-bottom: 1rem;">
      Total Monthly Budget (â‚¹):
      <input type="number" id="budget" name="budget" value="{{ request.form.budget or '8000' }}" required
        style="width: 100%; max-width: 300px; margin-top: 0.25rem;">
    </label>

    <h3 class="setup-heading" style="margin-top: 1.5rem; margin-bottom: 1rem;">Category Limits</h3>

    <label class="setup-label" style="display: block; margin-bottom: 1rem;">
      Food & Dining (â‚¹):
      <input type="number" id="food" name="food_limit" value="{{ request.form.food_limit or '3000' }}" required
        style="width: 100%; max-width: 300px; margin-top: 0.25rem;">
    </label>

    <label class="setup-label" style="display: block; margin-bottom: 1rem;">
      Travel & Transport (â‚¹):
      <input type="number" id="travel" name="travel_limit" value="{{ request.form.travel_limit or '2000' }}" required
        style="width: 100%; max-width: 300px; margin-top: 0.25rem;">
    </label>

    <label class="setup-label" style="display: block; margin-bottom: 1rem;">
      Entertainment (â‚¹):
      <input type="number" id="ent" name="entertainment_limit" value="{{ request.form.entertainment_limit or '1000' }}"
        required style="width: 100%; max-width: 300px; margin-top: 0.25rem;">
    </label>

    <button type="submit" class="btn"
      style="background: linear-gradient(135deg, #10b981, #059669); color: white; margin-top: 1rem;">Save &
      Continue</button>
  </form>
</div>

<script>
  function checkBudget() {
    var budget = parseFloat(document.getElementById('budget').value) || 0;
    var food = parseFloat(document.getElementById('food').value) || 0;
    var travel = parseFloat(document.getElementById('travel').value) || 0;
    var ent = parseFloat(document.getElementById('ent').value) || 0;
    var sum = food + travel + ent;

    if (Math.abs(sum - budget) > 0.01) {
      alert('ğŸš« BUDGET MISMATCH!\n\nFood+Travel+Ent = â‚¹' + sum.toFixed(0) + '\nTotal Budget = â‚¹' + budget.toFixed(0) + '\n\nMake EXACTLY equal!');
      return false;
    }
    return true;
  }
</script>
{% endblock %}